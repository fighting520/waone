<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>挖哇 - 编辑注册</title>
<style>
*{ margin:0; padding:0}
body{ font: normal 100% "Microsoft YaHei", "tahoma"; background:#f6f6f6}
li{ list-style:none}
label,input,i,span{ vertical-align:middle; display:inline-table}
input,button,select,textarea{outline:none}
textarea{resize:none; vertical-align: top}
label{ color:#444; width:120px; height:30px; line-height:30px; text-align:right; display:inline-block}
img {
	max-width: 100%;
	border:0 none;
}
.left{ float:left}
.right{ float:right}
.header{ height:40px; width:100%; background:#383838; }
.header a{ color:#999999; font-size:14px; text-decoration:none; margin-left:15px}
.box{ width:1000px; margin:40px auto; padding:40px; border:1px solid #dedede; background:#FFF; font-size:14px; overflow:hidden}
.header a:hover{ color:#FFF}
.register{ width:600px; margin-top:40px}
.register>li{ margin-bottom:40px; position:relative}
.text{ width:340px; height:28px; border:1px solid #dedede; margin-left:20px; padding-left:5px; color:#666; display:inline-block}
.tip{ color:#8d8d8d; padding-left:140px; margin-top:5px; width:350px}
.checktip{ color:#8d8d8d; padding-left:140px; padding-bottom:10px; margin-top:5px; width:350px}
.tip>span{ display:block}
.code{ margin:10px 0 0 140px; width:130px; height:50px; background:#CCC}
.submit{ padding:10px 50px; border:1px solid #86DB00; margin-left:140px; background:#4bbd00; color:#EDFFD1; font-size:14px}
.submit:hover{ background:#86DB00}
.tip_icon{ width:16px; height:16px; background-image: url(__IMG__/tips.png); background-repeat:no-repeat; background-position: -48px; margin-left:10px}
.result0{ background-position: center;}
.result1{ background-position:left}
.result2{ background-position:right}

.textarea{ width:320px; height:80px; margin-left:20px; border:1px solid #dedede; padding:5px; color:#666}
.details{ width:400px; height:200px; box-sizing:border-box; border-left: 1px dashed #dedede; padding:0 50px; margin-top:40px;}
.details>h3{ margin-bottom:20px; font-weight:normal}
.details>p{ color:#666; margin-bottom:8px}
.footer{ width:1000px; margin:0 auto; font-size:12px; text-align:center; margin-bottom:20px; color:#999}
a.res0{ color:#F00; display:block; }
a.res1{ color: #0C0; display:block; }
a.res2{ color: #F00; display:block; }


/* = uploadify上传插件样式------------------------------------------ */
.file{ position:absolute; left:120px; top:0}
.upload{ margin-left:20px;}
.uploadify-button {
	position: relative;
	text-align: center;
	color: #fff;
	cursor: pointer;
	background-color: #27ae60;
}
.uploadify-queue-item {
	position: absolute;
	margin-top: 4px;
	padding: 15px;
	width: 470px;
	border: 1px solid #ccc;
	background-color: #fff;
}
.uploadify-queue-item .cancel {
	float: right;
}
.uploadify-queue-item .cancel a,
.uploadify-queue-item .cancel a:hover {
	font-family: Consolas;
	color: #404040;
	text-decoration: none;
	border-bottom: 0 none;
}
.uploadify-queue-item .fileName {
	color: #2D7200;
}
.uploadify-error {
	background-color: #FDE5DD !important;
}
.uploadify-queue-item.completed {
	background-color: #E5E5E5;
}
.uploadify-progress {
	background-color: #E5E5E5;
	margin-top: 10px;
	width: 100%;
}
.uploadify-progress-bar {
	background-color: #0099FF;
	height: 3px;
	width: 1px;
}
.upload-img-box {
	margin:4px 0 0 140px;
	
}

.Validform_checktip{
	margin-left:0 0 8px 140px;
	color: #F00; display:block;
}
.upload-img-box .upload-pre-item {
	padding: 1px;
	width: 120px;
	max-height: 120px;
	overflow: hidden;
	text-align: center;
	cursor: pointer;
	border: 1px solid #ccc;
	transition: all .3s linear;
}
.upload-img-box .upload-pre-item img {
	vertical-align: top;
}
.upload-img-box .upload-pre-file {
	padding: 0 10px;
	width: 380px;
	height: 35px;
	line-height: 35px;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
	border: 1px dashed #ccc;
	background-color: #fff;
}

</style>
<script type="text/javascript" src="__STATIC__/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="__STATIC__/uploadify/jquery.uploadify.min.js"></script>


<script type="text/javascript">
$(function(){
	
	var url =  location.href;
	var n=url.indexOf("#");
	var lanmu = url.substring(n+1);
	if(lanmu=="youpin"){

	//	$("#lanmu").val("youpin");
		$("#lmxb").after("有品");
		$("#lanmu").attr("value","650");
	}else if(lanmu=="wenyi"){
		$("#lmxb").after("艺文");
		$("#lanmu").attr("value","29");
		$("#bqname").attr("value","艺文");
		 $(".ishide").hide();
	}else if(lanmu=="yueren"){
		$("#lmxb").after("乐人");
		$("#lanmu").attr("value","543");
		$("#bqname").attr("value","乐人");
		 $(".ishide").hide();
	}else if(lanmu=="app"){
		$("#lmxb").after("App");
		$("#lanmu").attr("value","30");
	}

	var verifyimg = $(".verifyimg").attr("src");
    $(".reloadverify").click(function(){
        if( verifyimg.indexOf('?')>0){
            $(".verifyimg").attr("src", verifyimg+'&random='+Math.random());
        }else{
            $(".verifyimg").attr("src", verifyimg.replace(/\?.*$/,'')+'?'+Math.random());
        }
    });
	
    $("form").submit(function(){
    		
    	
    	
    	
			var email = $("#email");
			var pwd = $("#password");
			var pwds = $("#passwords");
			var name = $("#name");
			
			var bqname=$("#bqname");
			var pimg = $("#cover_id_pimg");
			var des = $("#des");

			$("input").on("focus", function(){
				var that = $(this);
				that.data("value",that.val());
			})			
			
			$("input").on("blur", function(){
				var that = $(this);
				if(that.val() != that.data("value")){
					that.next("i").next("div.tip").children("span").html("");	
				}		
			})
			
			if(email.val() != ''){
				if(!email.val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)){
					email.focus().next("i").attr("class","tip_icon result2").next("div.tip").children("span").html("<a class='res2'>邮箱格式不正确</a>");
					return false;
				}else{
					email.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
				}
			}else{
				email.focus().next("i").attr("class","tip_icon result0").next("div.tip").children("span").html("<a class='res0'>邮箱不能为空</a>");
				return false;
			}
			
			if(pwd.val() != ''){
				if(!pwd.val().match(/^[a-zA-Z0-9_]{6,20}$/)) {
					pwd.focus().next("i").attr("class","tip_icon result2").next("div.tip").children("span").html("<a class='res2'>密码格式不正确</a>");
					return false;
				}else{
					pwd.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
				}
			}else{
				pwd.focus().next("i").attr("class","tip_icon result0").next("div.tip").children("span").html("<a class='res0'>密码不能为空</a>");
				return false;
			}
			
			if(pwds.val() == pwd.val()){
				pwds.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
			}else{
				pwds.focus().next("i").attr("class","tip_icon result2").next("div.tip").children("span").html("<a class='res2'>确认密码与密码不同</a>");
				return false;
			}
			
			if(name.val() != ''){
				if(!name.val().match(/^[\u4E00-\u9FA5a-zA-Z0-9-]{1,20}$/)) {
					name.focus().next("i").attr("class","tip_icon result2").next("div.tip").children("span").html("<a class='res2'>昵称格式不正确</a>");
					return false;
				}else{
					name.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
				}
			}else{
				name.focus().next("i").attr("class","tip_icon result0").next("div.tip").children("span").html("<a class='res0'>昵称不能为空</a>");
				return false;
			}
			
			
			if(bqname.val() != ''){
				
				bqname.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
				
			}else{
				bqname.focus().next("i").attr("class","tip_icon result0").next("div.tip").children("span").html("<a class='res0'>标签不能为空</a>");
				return false;
			}
			
			if(pimg.val() == ''){
				pimg.focus().next("div.tip").children("i").attr("class","tip_icon result0").next("span").html("<a class='res0'>头像不能为空</a>");
				return false;
			}else{
				pimg.focus().next("div.tip").children("i").attr("class","tip_icon result1").next("span").html("<a class='res1'>头像已设置</a>");
			}
			
			if(des.val() != ''){
				if(des.val().length > 120) {
					des.focus().next("i").attr("class","tip_icon result2").next("div.tip").children("span").html("<a class='res2'>简介字数太多</a>");
					return false;
				}else{
					des.focus().next("i").attr("class","tip_icon result1").next("div.tip").children("span");
				}
			}else{
				des.focus().next("i").attr("class","tip_icon result0").next("div.tip").children("span").html("<a class='res0'>简介不能为空</a>");
				return false;
			}
	
			
            var self = $(this);
    		
     
    		
    		$.post(self.attr("action"), self.serialize(), success, "json");
    		return false;

    		function success(data){
    			if(data.status){
    				window.location.href = data.url;
    			} else {
    				self.find(".Validform_checktip").text(data.info);
    				//刷新验证码
    				$(".reloadverify").click();
    			}
    		}
	

	})
	
	

})
</script>
</head>
<body>

<div class="header"><div style="width:1080px; margin:0 auto; overflow: hidden; height:40px; line-height:40px"><img class="left" src="__STATIC__/images/LOGO.png" alt="LOGO" height="40" /><a href="" style="margin-right:10px">首页</a><a target="_blank" href="http://wawa.fm" >官网</a>
<span class="right"><a href="{:U('Admin/Public/login')}">登陆</a><a href="{:U('Home/User/register')}">注册</a></span></div></div>
<div class="box">
	<form>
    	<ul class="register left">        
        	<li>
    			<input type="hidden" name="lanmu" id="lanmu"/>
    			
            	<label>邮箱</label><input id="email" name="email" class="text" type="text" /><i class="tip_icon"></i>
            	<div class="tip"><span></span><a class="rtip">请确认邮箱的准确性，审核完成后会以邮件形式通知您</a></div>
            </li>
        	<li>
            	<label>密码</label><input id="password" class="text" type="password" name="password"   /><i  class="tip_icon"></i>
            	<div class="tip"><span></span><a class="rtip">请输入密码(由英文、数字、下划线组成6~20个字符)</a></div>
            </li>
        	<li>
            	<label>确认密码</label><input id="passwords" class="text" type="password" name="repassword" /><i  class="tip_icon"></i>
            	<div class="tip"><span></span><a class="rtip">请再次输入密码</a></div>
            </li>
        	<li >
            	<label>昵称</label><input id="name" name="username"  class="text" type="text" /><i class="tip_icon"></i>
            	<div class="tip"><span></span><a class="rtip">好的昵称可以让更多用户记住您。<br />由中文、英文、数字、分割线组成20个字符长度</a></div>
            </li>   
            
            
            <li class="ishide">
            	<label>标签</label><input id="bqname" name="bqname"  class="text" type="text" /><i class="tip_icon"></i>
            	<div class="tip"><span style="width:320px"></span><a class="rtip">输入1~3个相关标签，以、间隔开。<br />例如：新奇、精品、文艺</a></div>
            </li > 
                     
        	<li>
            	<label>头像</label><span class=" upload transfrom"><input class="text  file1"  type="file" id="pimg" /></span>
            	
            	
            	<div class="upload-img-box"></div>
            	
            	<script type="text/javascript">
								//上传图片
							    /* 初始化上传插件 */
								$("#pimg").uploadify({
							        "height"          : 36,
							        "swf"             : "__STATIC__/uploadify/uploadify.swf",
							        "fileObjName"     : "download",
							        "buttonText"      : "上传图片",
							        "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
							        "width"           : 130,
							        'removeTimeout'	  : 1,
							        'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
							        "onUploadSuccess" : uploadPicture{$field.name},
							        'onFallback' : function() {
							            alert('未检测到兼容版本的Flash.');
							        }
							    });
								function uploadPicture{$field.name}(file, data){
							    //	var data = $.parseJSON(data);
							    var data =  eval("("+data+")");
							    	var src = '';
							    	
							        if(data.status){
							        	$("#cover_id_pimg").val(data.url);
							        	
							        	src = data.url;
							        	$("#cover_id_pimg").parent().find('.upload-img-box').html(
							        		'<div class="upload-pre-item"><img src="' + src + '"/></div>'
							        	);
							        	
							        	 $("#cover_id_pimg").focus().next("div.tip").children("i").attr("class","tip_icon result1").next("span").html("<a class='res1'>头像已设置</a>")
							        } else {
							        	updateAlert(data.info);
							        	setTimeout(function(){
							                $('#top-alert').find('button').click();
							                $(that).removeClass('disabled').prop('disabled',false);
							            },1500);
							        }
							    }
								</script>
            	<input type="hidden" name="pimg"  id="cover_id_pimg"/> 
            	<div class="tip"><i class="tip_icon" style="float:left; margin:2px 5px 0 0; vertical-align:middle"></i><span style="float:left; display: block; vertical-align:middle;"></span><br /><a class="rtip" >有逼格的头像可以吸引更多粉丝。</a><br />jpg、png格式（1*1比例尺寸）
            	
            	</div>
            </li>
        	<li>
            	<label>二维码名片</label><span class="upload transfrom"><input class="text file2" type="file" id="card"   /></span>
            	<i></i>
            	<input type="hidden" name="card"  id="cover_id_card"/>
            	<div class="upload-img-box">
									</div>
            	
            	<script type="text/javascript">
								//上传图片
							    /* 初始化上传插件 */
								$("#card").uploadify({
							        "height"          : 36,
							        "swf"             : "__STATIC__/uploadify/uploadify.swf",
							        "fileObjName"     : "download",
							        "buttonText"      : "上传图片",
							        "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
							        "width"           : 130,
							        'removeTimeout'	  : 1,
							        'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
							        "onUploadSuccess" : uploadPicture{$field.name},
							        'onFallback' : function() {
							            alert('未检测到兼容版本的Flash.');
							        }
							    });
								function uploadPicture{$field.name}(file, data){
							   // 	var data = $.parseJSON(data);
							   var data =  eval("("+data+")");
							    	var src = '';
							    	
							        if(data.status){
							        	$("#cover_id_card").val(data.url);
							        	
							        	src = data.url;
							        	$("#cover_id_card").parent().find('.upload-img-box').html(
							        		'<div class="upload-pre-item"><img src="' + src + '"/></div>'
							        	);
							        	
							        } else {
							        	updateAlert(data.info);
							        	setTimeout(function(){
							                $('#top-alert').find('button').click();
							                $(that).removeClass('disabled').prop('disabled',false);
							            },1500);
							        }
							    }
								</script>
            	<div class="tip"><span></span><a class="rtip">如果您有微信公众号，上传二维码吧。</a><br />jpg、png格式（1*1比例尺寸）</div>
            </li>
        	<li>
            	<label>简介</label><textarea id="des" class="textarea"  name="remark"></textarea><i  class="tip_icon"></i>
            	<div class="tip"><span></span><a class="rtip">简单介绍下自己（60个中文字）</a></div>
            </li>            
        	<li>
            	<label>验证码</label><input class="text" type="text" style="width:124px" name="verify" /><i  class="tip_icon"></i>
            	
                <div class="tip"><span></span><img class="verifyimg reloadverify" alt="点击切换" src="{:U('verify')}" style="cursor:pointer;"><br><a class="rtip">点击图片刷新验证码</a></div>
                
               
            </li>  
         
             <div class="checktip Validform_checktip"></div>    
                              
            <li><input id="submit" class="submit transfrom" type="submit" value="注册" /></li>                              
        </ul>
    </form>
    <div class="details left">
    	<h3>欢迎入驻挖哇<xb  id="lmxb"></xb>小编</h3>
        <p style="margin-bottom:5px">注册须知：</p>
        <p>1、已阅读并同意<a href="" style="color: #06F; text-decoration: none">《挖哇编辑入驻协议》</a></p>
        <p>2、请根据规则填写完整表单并提交。</p>
        <p>3、提交后会进行审核，结果会邮件提醒。</p>
    </div>
</div>
<div class="footer">©2014-2015   广州市伟图信息技术有限公司<br /> 粤ICP备13077837号-2</div>
</body>
</html>
