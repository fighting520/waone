<extend name="Public/base"/>

<block name="body">
    <div class="main-title">
        <h2>新增用户</h2>
    </div>
    <form action="{:U()}" method="post" class="form-horizontal">
    
    
       <div class="control-group">
            <label class="item-label" for="inputEmail">栏目</label>
            <div class="controls">
     
              
              <select name="lanmu" >
<option value="543">乐人</option>
<option value="650">有品</option>
<option value="30">App</option>
<option value="29">文艺</option>
<option value="22">其他</option>
</select>
            </div>
          </div>
        
    
    
    
        <div class="form-item">
            <label class="item-label">用户名<span class="check-tips">（用户名会作为默认的昵称）</span></label>
            <div class="controls">
                <input type="text" class="text input-large" name="username" value="">
            </div>
        </div>
        
        <div class="form-item">
            <label class="item-label">标签<span class="check-tips">（用、（顿号）隔开）</span></label>
            <div class="controls">
                <input type="text" class="text input-large" name="bqname" value="" >
            </div>
         </div>
        
        <div class="form-item">
            <label class="item-label">密码<span class="check-tips">（用户密码不能少于6位）</span></label>
            <div class="controls">
                <input type="password" class="text input-large" name="password" value="">
            </div>
        </div>
        <div class="form-item">
            <label class="item-label">确认密码</label>
            <div class="controls">
                <input type="password" class="text input-large" name="repassword" value="">
            </div>
        </div>
        <div class="form-item">
            <label class="item-label">邮箱<span class="check-tips">（用户邮箱，用于找回密码等安全操作）</span></label>
            <div class="controls">
                <input type="text" class="text input-large" ajaxurl="Home/member/checkUserEmailUnique.html" errormsg="请填写正确格式的邮箱" nullmsg="请填写邮箱" datatype="e" value="" name="email">
            </div>
        </div>
        
        
        
           
          <div class="control-group">
            <label class="item-label" for="inputEmail">头像</label>
            
            
              <div class="controls">
									<input type="file" id="upload_picture_pimg">
									<input type="hidden" name="pimg" nullmsg="请填写用户名" id="cover_id_pimg"/>
									<div class="upload-img-box">
									</div>
								</div>
								<script type="text/javascript">
								//上传图片
							    /* 初始化上传插件 */
								$("#upload_picture_pimg").uploadify({
							        "height"          : 30,
							        "swf"             : "__STATIC__/uploadify/uploadify.swf",
							        "fileObjName"     : "download",
							        "buttonText"      : "上传图片",
							        "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
							        "width"           : 120,
							        'removeTimeout'	  : 1,
							        'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
							        "onUploadSuccess" : uploadPicture{$field.name},
							        'onFallback' : function() {
							            alert('未检测到兼容版本的Flash.');
							        }
							    });
								function uploadPicture{$field.name}(file, data){
							    	//var data = $.parseJSON(data);
							    	var data =  eval("("+data+")");
							    	var src = '';
							    	
							        if(data.status){
							        	$("#cover_id_pimg").val(data.url);
							        	
							        	src = data.url;
							        	$("#cover_id_pimg").parent().find('.upload-img-box').html(
							        		'<div class="upload-pre-item"><img src="' + src + '"/></div>'
							        	);
							        } else {
							        	updateAlert(data.info);
							        	setTimeout(function(){
							                $('#top-alert').find('button').click();
							                $(that).removeClass('disabled').prop('disabled',false);
							            },1500);
							        }
							    }
								</script>
            
            
            
              
            
          </div>
          
          <div class="control-group">
            <label class="item-label" for="inputEmail">明信片</label>
             <div class="controls">
									<input type="file" id="upload_picture_card">
									<input type="hidden" name="card" nullmsg="请填写用户名" id="cover_id_card"/>
									<div class="upload-img-box">
									</div>
								</div>
								<script type="text/javascript">
								//上传图片
							    /* 初始化上传插件 */
								$("#upload_picture_card").uploadify({
							        "height"          : 30,
							        "swf"             : "__STATIC__/uploadify/uploadify.swf",
							        "fileObjName"     : "download",
							        "buttonText"      : "上传图片",
							        "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
							        "width"           : 120,
							        'removeTimeout'	  : 1,
							        'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
							        "onUploadSuccess" : uploadPicture{$field.name},
							        'onFallback' : function() {
							            alert('未检测到兼容版本的Flash.');
							        }
							    });
								function uploadPicture{$field.name}(file, data){
							    	//var data = $.parseJSON(data);
							    	var data =  eval("("+data+")");
							    	var src = '';
							    	
							        if(data.status){
							        	$("#cover_id_card").val(data.url);
							        	
							        	src = data.url;
							        	$("#cover_id_card").parent().find('.upload-img-box').html(
							        		'<div class="upload-pre-item"><img src="' + src + '"/></div>'
							        	);
							        } else {
							        	updateAlert(data.info);
							        	setTimeout(function(){
							                $('#top-alert').find('button').click();
							                $(that).removeClass('disabled').prop('disabled',false);
							            },1500);
							        }
							    }
								</script>
          </div>
          
           <div class="control-group">
            <label class="item-label" >备注</label>
            <div class="controls">
             
              <textarea  name="remark" cols="30"   rows="4"  nullmsg="清填写备注"
					maxlength="200" class="input-xxlarge" ></textarea>
            </div>
          </div>
        
        
        <div class="form-item">
            <button class="btn submit-btn ajax-post" id="submit" type="submit"  onclick="return check(this.form)" target-form="form-horizontal">确 定</button>
            <button class="btn btn-return" onclick="javascript:history.back(-1);return false;">返 回</button>
        </div>
    </form>
</block>

<block name="script">
    <script type="text/javascript">
        //导航高亮
        highlight_subnav('{:U('User/index')}');
        
        
   	 function check(form) {

         if(form.username.value=='') {
               alert("请输入用户帐号!");
               form.username.focus();
               return false;
          }
         
         if(form.bqname.value=='') {
             alert("请输入标签!");
             form.bqname.focus();
             return false;
        }
         
         if(form.password.value=='') {
             alert("请输入密码!");
             form.password.focus();
             return false;
        }
         
         if(form.repassword.value=='') {
             alert("请输入确认密码!");
             form.repassword.focus();
             return false;
        }
         
         if(form.email.value=='') {
             alert("请输入邮箱!");
             form.email.focus();
             return false;
        }
         
        
         
         if(form.pimg.value=='') {
             alert("请上传头像!");
             form.pimg.focus();
             return false;
        }
         
        if(form.card.value=='') {
             alert("请上传明信片!");
             form.card.focus();
             return false;
        }
        
        
        if(form.remark.value=='') {
            alert("请输入备注!");
            form.remark.focus();
            return false;
       }
    
        return true;
   }
    </script>
</block>
